document.getElementsByName("func_expr")[0].addEventListener("keydown",keydownhandler),document.getElementsByName("func_expr")[0].focus();var plot=new Fooplot(document.getElementsByName("plot")[0]);function keydownhandler(t){switch(t.key){case"Enter":draw_func();break;case"Call":plot.deleteAllPlots(),plot.reDraw()}}let input=document.getElementById("input"),softkey_left=document.querySelector(".softkey-left"),_inputIsActivate=!0,_isHelp=!1,help=document.getElementById("help");function draw_x2(){(plot=new Fooplot(document.getElementsByName("plot")[0])).addPlot("sin(x^2)*abs(x)-2x",FOOPLOT_TYPE_FUNCTION,{color:"#ff00f0"}),plot.reDraw()}function draw_func(){var t=document.getElementsByName("func_expr")[0].value,e=["#ffff00","#ff00ff","#ff0000","#008888","#008800","#fff","hotpink"],o=e[Math.floor(Math.random()*e.length)];plot.addPlot(t,null,{color:o}),plot.reDraw()}function screenshot(t){let e=document.getElementById("noimg");!function(t,e){const o=function(t){return URL.createObjectURL(new Blob([t],{type:"image/svg+xml"}))}(t);!function(t,e){const o=document.createElement("img");o.id="what",document.body.appendChild(o),o.onload=function(){const t=document.createElement("canvas");t.width=o.clientWidth,t.height=o.clientHeight,t.getContext("2d").drawImage(o,0,0);const n=t.toDataURL("image/png");e(n)},o.src=t}(o,t=>{e(t),URL.revokeObjectURL(o)})}(t,t=>{const o=document.createElement("img");o.id="down",e.appendChild(o),o.src=t}),setTimeout((function(){let t="";for(let e=0;e<plot.plots.length;e++)t+=plot.plots[e].eq+"___";let e=document.getElementById("down"),o=document.createElement("a");console.log(e),o.href=e.src,o.id="link",o.download=t,o.text="dw",document.body.appendChild(o),o.click()}),200),setTimeout(()=>{let t=document.getElementById("noimg"),e=document.getElementById("down"),o=document.getElementById("link");t.removeChild(e),document.body.removeChild(o);let n=document.getElementById("what");document.body.removeChild(n)},400)}function moveout(){if(plot.zoomTimeout)return null;var t=plot.dpx/plot.width*(plot.xmax-plot.xmin),e=plot.dpy/plot.height*(plot.ymax-plot.ymin);plot.xmin-=t,plot.xmax-=t,plot.ymin+=e,plot.ymax+=e,plot.dpx=0,plot.dpy=0,plot.subcontainer.style.left="0px",plot.subcontainer.style.top="0px",plot.reDraw(),plot.onWindowChange([plot.xmin,plot.xmax,plot.ymin,plot.ymax])}function movein(t,e){plot.subcontainer.style.left=t+"px",plot.subcontainer.style.top=e+"px",plot.dpx=t,plot.dpy=e}document.addEventListener("keydown",(function(t){switch(t.key){case"SoftLeft":case"Control":if(_inputIsActivate)return input.blur(),softkey_left.innerHTML="NavMode",_inputIsActivate=!1;if(!_inputIsActivate)return input.focus(),softkey_left.innerHTML="EditMode",_inputIsActivate=!0;break;case"ArrowLeft":_inputIsActivate||(movein(20,0),moveout());break;case"ArrowRight":_inputIsActivate||(movein(-20,0),moveout());break;case"ArrowUp":_inputIsActivate||(movein(0,20),moveout());break;case"ArrowDown":_inputIsActivate||(movein(0,-20),moveout());break;case"1":_inputIsActivate||plot.zoom(1.1);break;case"3":_inputIsActivate||plot.zoom(.9);break;case"*":_inputIsActivate||screenshot(plot.getSVG());break;case"Call":case"Shift":plot.deleteAllPlots(),plot.reDraw();break;case"SoftRight":case"Meta":if(!_isHelp)return help.style.height="100%",_isHelp=!0;if(_isHelp)return help.style.height="0%",_isHelp=!1}}));